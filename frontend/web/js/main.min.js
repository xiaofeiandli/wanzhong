!function(){function a(a){var c={},d={zh:"请输入验证码",en:"Please enter verification code"};c.loading="<div class='sm-modal-content'><img src='/images/loading.gif'></div>",c.code="<div class='sm-modal-content'><div class='verify-container'><h3 class='verify-title'>"+d[b]+"</h3><div class='verify-content'><div class='form-item'><input class='form-control verify-code' maxlength='6'></div><img class='verify-image' src></div></div></div>",this.$cover=$("<div/>",{"class":"modal-cover"}).appendTo("body"),this.$modal=$("<div/>",{"class":"modals",html:"<div class='sm-modal-dialog'>"+c[a]+"</div>"}).appendTo("body"),"code"==a&&(this.$code=this.$modal.find(".verify-code"),this.$image=this.$modal.find(".verify-image"))}var b=$("#en").get(0)?"en":"zh",c="en"==b?"/en/":"/";"zh"==b&&$("body").attr("id","zh"),a.prototype.show=function(){this.$cover.fadeIn(),this.$modal.css({visibility:"visible"}).fadeIn()},a.prototype.hide=function(){this.$cover.fadeOut(),this.$modal.css({visibility:"hidden"}).fadeOut()};var d=new a("loading"),e=function(){function a(){setInterval(function(){e.eq(b).animate({left:"-100%"},2e3,function(){$(this).css("left","100%"),b=b+1==f?0:b+1}),e.eq(b+1==f?0:b+1).animate({left:"0"},2e3)},5e3)}var b=0,c=0,d=$("#banners"),e=d.find(".banner-item"),f=e.length;d.find(".banner-image").load(function(){++c==f&&a()}).each(function(){this.complete&&++c==f&&a()})},f=function(){function e(){var a=$("#card"),b=$("#card_select"),c=$("#card_view");b.change(function(){$(this).val().length<1||$("#card_form").ajaxSubmit({url:"/application/putfile",type:"POST",dataType:"JSON",beforeSend:function(){d.show()},success:function(b){0==b.code?(a.val(b.data),c.html("<i class='icon remove'></i><img src='"+b.data+"'>")):alert(b.msg)},error:function(a){alert(a.responseText)},complete:function(){d.hide()}})}),c.on("click",function(d){var e=$(d.target).get(0),f=c.find(".remove").get(0);f!=e?b.click():(a.val(""),c.html(""))})}function f(){for(var a=0;a<t[k].length;a++){var b=t[k][a];if("purpose"!=b&&"website"!=b&&"card"!=b){if(!s[b]())return q=!1,!1;r[b]=s[b]()}else r[b]=s[b]()}return q=!0}function g(){for(var a=u[k][b],c="",d=0;d<t[k].length;d++){var e=t[k][d],f=a[d],g="";"certificate_type"!=e&&(g="certificate_number"==e?a[2]+" "+r[e]:"purpose"==e?"<p>"+r[e]+"</p>":"card"==e?r[e]?"<img src='"+r[e]+"'>":"":r[e],c+="<tr><td>"+f+"</td><td>"+g+"</td></tr>")}o.find("table").html("<tbody>"+c+"</tbody>")}function h(){$("body").animate({scrollTop:0},500)}function i(){$.ajax({url:"/site/captcha?refresh",dataType:"JSON",cache:"false",success:function(a){w.$image.prop("src",a.url)}})}function j(){$.ajax({url:c+"application/doapply",type:"POST",data:r,dataType:"JSON",beforeSend:function(){d.show()},success:function(a){0==a.code&&200==a.status?(n.remove(),o.remove(),p.show(),l.text(v.success[b]),"person"==k&&$("#code").attr("href",a.data.qrcode).html("<img src='"+a.data.qrcode+"'>"),h(),window.onbeforeunload=null):alert(a.msg)},error:function(a){alert(a.responseText)},complete:function(){d.hide()}})}var k=$("#apply").attr("data-type"),l=$("#apply_title"),m=l.text(),n=$("#apply_form"),o=$("#apply_info"),p=$("#apply_result"),q=!1,r={type:function(){var a=0;return"media"==k?a=1:"company"==k&&(a=2),a}()};$("#company").find("input").on("blur",function(){Verify.empty("#company","input","company")}),$("#name").find("input").on("blur",function(){Verify.empty("#name","input","name")}),$("#position").find("input").on("blur",function(){Verify.empty("#position","input","position")}),$("#cellphone").find("input").on("blur",function(){Verify.reg("#cellphone","cellphone")}),$("#telephone").find("input").on("blur",function(){Verify.telephone("#telephone")}),$("#email").find("input").on("blur",function(){Verify.reg("#email","email")}),$("#address").find("select").on("blur change",function(){var a=$(this).attr("name");Verify.select("#address",a)}).end().find("input").on("blur",function(){Verify.empty("#address","input","address")}),$("#area").find("select").on("blur change",function(){Verify.select("#area","area")}),$("#classes").find("select").on("blur change",function(){Verify.select("#classes","classes")});var s={company:function(){return Verify.empty("#company","input","company",!0)},media:function(){return Verify.empty("#company","input","company",!0)},name:function(){return Verify.empty("#name","input","name",!0)},certificate_type:function(){return $("#id").find("select").val()},certificate_number:function(){return Verify.reg("#id","id",!0)},position:function(){return Verify.empty("#position","input","position",!0)},cellphone:function(){return Verify.reg("#cellphone","cellphone",!0)},telephone:function(){return Verify.telephone("#telephone",!0)},email:function(){return Verify.reg("#email","email",!0)},address:function(){return!!(Verify.select("#address","province",!0)&&Verify.select("#address","city",!0)&&Verify.empty("#address","input","address",!0))&&Verify.select("#address","province")+" "+Verify.select("#address","city")+" "+Verify.empty("#address","input","address")},area:function(){return Verify.select("#area","area",!0)},classes:function(){return Verify.select("#classes","classes",!0)},purpose:function(){return $("#purpose").find("textarea").val()},website:function(){return $("#website").find("input").val()},card:function(){return $("#card").val()}},t={person:["name","cellphone","certificate_type","certificate_number","email","company","position"],media:["name","cellphone","certificate_type","certificate_number","email","company","position","address","card"],company:["company","name","position","telephone","email","address","website","purpose","area","classes"]},u={person:{zh:["姓名","手机","身份证","证件号码","邮箱地址","公司","职位"],en:["NAME","MOBILE PHONE","ID card","ID NO.","EMAIL","COMPANY","POSITION"]},media:{zh:["姓名","手机","身份证","证件号码","邮箱地址","公司","职位","地址","电子名片"],en:["NAME","MOBILE PHONE","ID card","ID NO.","EMAIL","COMPANY","POSITION","ADDRESS","CARD"]},company:{zh:["公司名称","联系人","职位","联系电话","邮箱地址","公司地址","公司网站","参展目的","参展面积","参展类型"],en:["COMPANY NAME","CONTACT PERSON","POSITION","TELEPHONE NO.","EMAIL","COMPANY ADDRESS","COMPANY WEBSITE","PURPOSE FOR PARTICIPATION","BOOTH AREA","CATEGORY"]}},v={confirm:{zh:"信息确认",en:"CONFORMATION"},success:{zh:"报名成功",en:"REGISTRATION COMPLETED"}};"media"==k&&e(),n.find(".submit").on("click",function(){f()&&(l.text(v.confirm[b]),n.hide(),o.show(),g(),h())}),o.find(".back").on("click",function(){l.text(m),n.show(),o.hide(),h()});var w=new a("code");i(),w.$image.on("click",function(){i()}),w.$code.on("keyup",function(){w.$code.removeClass("error"),6==this.value.length&&$.ajax({url:"/application/validatecode",type:"POST",data:"captcha="+this.value,success:function(a){0==a.code&&q?(w.hide(),j()):w.$code.addClass("error")}})}),o.find(".submit").on("click",function(){w.show()}),window.onbeforeunload=function(a){return(a||window.event).returnValue="系统可能不会保存您所做的更改"}},g=function(){function a(a){a.find(".news-item-title").dotdotdot({height:54,wrap:"letter"}),a.find(".news-item-summary").dotdotdot({height:100,wrap:"letter"})}var d=$("#news_list"),e=$("#add_more"),f=e.attr("data-page"),g=e.attr("data-total"),h=e.attr("data-id"),i=e.attr("data-last"),j=d.hasClass("grid")?"grid":"list",k={zh:{normal:"加载更多",loading:"加载中...",none:"没有更多了"},en:{normal:"Load for more",loading:"Loading...",none:"End of the page"}};"grid"==j&&(a(d),d.masonry({itemSelector:".news-item",gutter:20,isAnimated:!0})),e.data("value",!0).on("click",function(){e.data("value")&&(e.data("value",!1).text(k[b].loading),$.ajax({url:c+"news/ajaxlist/"+j+"/"+h+"/"+f+"/"+i,type:"GET",dataType:"JSON",success:function(c){if(0==c.code&&200==c.status){if("grid"==j){var h=$("<div/>").append(c.data.data);h.find(".news-item").each(function(){var b=$(this);d.append(b).masonry("appended",b),a(b)})}else d.append(c.data.data);g<12*f?e.data("value",!1).text(k[b].none):(e.data("value",!0).text(k[b].normal),f++,i=c.data.last)}else e.data("value",!0).text(c.msg)}}))})},h=function(){function a(){var a=$(window).height();a<700?g.find(".modal-dialog").css("margin-top",100):g.find(".modal-dialog").css("margin-top",(a-h)/2-50)}function b(b){var e=$(b).attr("data-id"),h=$(b).attr("data-color");$.ajax({type:"POST",url:c+"forum/detail",dataType:"JSON",data:"aid="+e,beforeSend:function(){d.show()},success:function(b){0==b.code&&200==b.status&&(h=h?h:"url('/images/modal-bg.jpg') repeat-y",g.html(b.data).find(".modal-content").css("background",h).find(".modal-body").perfectScrollbar(),a())},complete:function(){d.hide()}}),f.fadeIn(),g.css({visibility:"visible"}).fadeIn()}function e(){f.fadeOut(),g.css({visibility:"hidden"}).fadeOut()}var f=$("<div/>",{"class":"modal-cover"}).appendTo("body"),g=$("<div/>",{"class":"modals"}).appendTo("body"),h=490;$("#forums").on("click",".forum-detail",function(){b(this)}),$("#main_forum").on("click",function(){b(this)}),g.on("click",".close",function(){e()}),$(document).on("keydown",function(a){var b=a.keyCode?a.keyCode:a.which;27==b&&e()})},i=function(a){function b(a){var b=new BMap.Map(a.container);b.enableScrollWheelZoom();var c=new BMap.Geocoder;c.getPoint(a.address,function(a){if(a){b.centerAndZoom(a,14);var c=new BMap.Marker(a);b.addOverlay(c)}},a.city)}var c={container:a,city:"杭州",address:"杭州国际博览中心"};b(c)},j=function(a){var b=$("#"+a+"s"),c=b.find("."+a),e=b.find(".number"),f=b.find(".all"),g=b.find("."+a).length,h=0;return c.each(function(){$(this).data("id",$(this).attr("data-id"))}),b.on("click","."+a,function(a){a.preventDefault();var b=$(this).data("checked");b?($(this).data("checked",!1).removeClass("checked"),h--,h<1&&f.data("checked",!1).removeClass("checked")):($(this).data("checked",!0).addClass("checked"),h++),e.text(h)}),b.on("click",".all",function(d){d.preventDefault();var f=$(this).data("checked");f?(h=0,$(this).data("checked",!1).removeClass("checked"),b.find("."+a).each(function(){$(this).data("checked",!1).removeClass("checked")})):(h=g,$(this).data("checked",!0).addClass("checked"),c.each(function(){$(this).data("checked",!0).addClass("checked")})),e.text(h)}),b.on("click",".download-btn",function(){for(var b=[],e=0;e<g;e++){var f=c.eq(e).data("checked");f&&b.push(c.eq(e).data("id"))}var h="pdf"==a?"pdf":"image";b.length<1||$.ajax({url:"/resource/download/"+h+"/"+b.toString(),type:"GET",dataType:"JSON",beforeSend:function(){d.show()},success:function(a){0==a.code&&200==a.status?location.href=a.data.zip_path:alert(a.msg)},complete:function(){d.hide()}})}),!0};$(document).ready(function(){$("#index").get(0)&&e(),$("#apply").get(0)&&f(),$("#news").get(0)&&g(),$("#forums").get(0)&&h(),$("#download_page").get(0)&&j("pdf")&&j("img"),$("#map").get(0)&&i("map")})}(jQuery);